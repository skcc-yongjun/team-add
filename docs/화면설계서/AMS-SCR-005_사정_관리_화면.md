# 사정 관리 화면 (AMS-SCR-005)

## 사용 역할자: 입학처 담당자, 시스템 관리자

---

## 기능 1: 사정 점검 및 진행 관리

-   **관련 요구사항:** AMS-REQ-012: 사정 점검 관리
-   **입력 정보:**
    -   사정 대상 선택 (모집 시기, 전형, 모집 단위 등).
    -   '사정 시작' 또는 '다음 단계 진행' 버튼 클릭.
    -   점검 항목 체크리스트 확인 및 체크 (예: 평가 완료 여부, 동점자 처리 기준 설정 여부 등).
-   **출력 정보:**
    -   사정 대상 지원자 목록 (현재 사정 단계, 점수 요약 등 표시).
    -   사정 진행 상태 표시 (예: 준비중, 1단계 진행중, 완료).
    -   사정 점검 체크리스트 및 상태.
    -   사정 관련 로그 또는 특이사항 알림.
-   **프로세스 설명:**
    1.  사용자가 사정을 진행할 대상을 선택한다.
    2.  시스템은 해당 대상의 사정 진행 상태와 점검 항목을 조회하여 표시한다. (API 호출)
    3.  사용자는 점검 항목을 확인하고, 사정 시작 또는 다음 단계 진행을 위한 버튼을 클릭한다.
    4.  클라이언트는 해당 명령을 API로 전송한다.
    5.  서버는 사정 로직(점수 계산, 순위 부여 등)을 수행하거나, 상태를 업데이트한다. (상세 로직은 기능 2, 3에서 처리)
    6.  사정 진행 중 발생하는 로그나 필요한 확인 사항을 클라이언트에 반환하여 표시한다.
-   **호출 API 정보:**
    -   상태 조회 API:
        -   HTTP 메서드: GET
        -   API 엔드포인트: `/api/ams/admissions/status`
        -   요청 파라미터: 사정 대상 조건
        -   응답 파라미터: 사정 진행 상태, 점검 항목, 관련 로그
    -   사정 진행 API:
        -   HTTP 메서드: POST
        -   API 엔드포인트: `/api/ams/admissions/process/start` 또는 `/api/ams/admissions/process/next-step`
        -   요청 파라미터 (Body): 사정 대상 조건
        -   응답 파라미터: 진행 결과 (성공, 실패, 다음 단계 정보 등)
-   **Mockup 데이터 예시:**
    -   입력 (조회): `/api/ams/admissions/status?admissionRound=2024S&admissionType=COMP`
    -   출력 (조회): "사정 준비 완료" 상태, 점검 항목 목록 표시.
    -   입력 (시작 POST `/api/ams/admissions/process/start`): `{ "admissionRound": "2024S", ... }`
    -   출력 (시작): "사정 1단계 처리 시작됨." 메시지, 진행 상태 업데이트.

## 기능 2: 점수 계산 및 최종 배점 관리

-   **관련 요구사항:** AMS-REQ-013: 점수 계산 및 최종 배점 관리
-   **입력 정보:** (주로 시스템 내부 처리 또는 확인 과정)
    -   사정 대상 및 기준 확인 (이전 단계에서 설정됨).
    -   '최종 점수 계산 실행' 버튼 클릭 (필요시).
    -   동점자 처리 규칙 적용 확인 및 선택.
-   **출력 정보:**
    -   지원자별 각 평가 단계 점수, 환산 점수, 최종 총점, 석차 표시 테이블.
    -   동점자 목록 및 처리 결과 표시.
    -   점수 계산 로그 또는 오류 보고.
-   **프로세스 설명:**
    1.  사정 진행 단계에서 최종 점수 계산 로직이 트리거된다 (자동 또는 수동).
    2.  서버는 설정된 배점 기준(AMS-SCR-004 기능 1에서 관리)에 따라 각 지원자의 평가 단계별 점수(학생부, 수능, 서류, 면접 등)를 합산하고 환산 공식을 적용하여 최종 총점을 계산한다. (`EVALUATION` 데이터 사용)
    3.  계산된 총점을 기준으로 지원자들의 석차를 매긴다.
    4.  동점자 발생 시, 미리 설정된 동점자 처리 규정(예: 특정 영역 점수 우선)에 따라 순위를 조정한다.
    5.  계산된 최종 점수와 석차를 `ADMISSION_DECISION` 테이블에 저장하거나 업데이트한다.
    6.  결과를 클라이언트가 조회할 수 있도록 API를 통해 제공한다.
-   **호출 API 정보:**
    -   점수 계산 실행 API:
        -   HTTP 메서드: POST
        -   API 엔드포인트: `/api/ams/admissions/calculate-scores`
        -   요청 파라미터 (Body): 사정 대상 조건
        -   응답 파라미터: 처리 결과 (성공/실패, 처리 건수 등)
    -   최종 점수 및 순위 조회 API:
        -   HTTP 메서드: GET
        -   API 엔드포인트: `/api/ams/admissions/results/scores`
        -   요청 파라미터: 사정 대상 조건
        -   응답 파라미터: 지원자별 최종 점수 및 순위 목록
            ```json
            [
              {
                "applicationId": 1001, "applicantId": "2024S0001", "name": "홍길동",
                "scores": {"document": 85.5, "interview": 90.0, ...},
                "convertedScore": 88.75,
                "totalScore": 88.75,
                "rank": 1,
                "tieBreakerRank": 1 // 동점자 처리 후 순위
              }, ...
            ]
            ```
-   **Mockup 데이터 예시:**
    -   입력 (계산 실행): POST 요청
    -   출력 (계산 완료): "최종 점수 계산 완료" 메시지.
    -   입력 (결과 조회): GET 요청
    -   출력 (결과 조회): 상기 응답 구조의 데이터가 테이블에 표시됨.

## 기능 3: 사정 결과 확정

-   **관련 요구사항:** AMS-REQ-011 ~ AMS-REQ-014 포괄 (최종 단계)
-   **입력 정보:**
    -   사정 결과(합격/예비/불합격) 확인.
    -   모집 단위별 합격 인원, 예비 순위 범위 확인 및 조정 (필요시).
    -   '사정 결과 최종 확정' 버튼 클릭. (매우 신중한 작업임을 알리는 확인 절차 포함)
-   **출력 정보:**
    -   최종 확정된 합격자, 예비 합격자, 불합격자 명단 표시.
    -   확정 완료 메시지.
    -   확정된 사정 결과 데이터는 변경 불가 상태로 전환됨을 안내.
-   **프로세스 설명:**
    1.  모든 점수 계산 및 순위 결정이 완료된 후, 담당자가 최종 결과를 검토한다.
    2.  모집 단위별 정원에 맞춰 합격/예비/불합격 상태를 시스템이 제안하거나, 담당자가 최종 확인한다. (예비 순위 부여 포함)
    3.  '사정 결과 최종 확정' 버튼을 클릭하면, 되돌릴 수 없음을 경고하는 확인창이 표시된다.
    4.  사용자가 최종 확인하면, 클라이언트는 확정 명령 API를 호출한다.
    5.  서버는 해당 사정 대상 지원자들의 `ADMISSION_DECISION` 테이블의 `decision_result` (합격/예비/불합), `preliminary_rank` (예비 순위) 등을 최종 업데이트하고, 상태를 '확정됨'으로 변경한다. (이후 수정 제한)
    6.  확정 결과를 클라이언트에 반환한다.
-   **호출 API 정보:**
    -   사정 결과 확정 API:
        -   HTTP 메서드: POST
        -   API 엔드포인트: `/api/ams/admissions/finalize`
        -   요청 파라미터 (Body): 확정 대상 조건 (모집 시기, 전형 등)
        -   응답 파라미터: 확정 성공/실패 정보
-   **Mockup 데이터 예시:**
    -   입력: 최종 확인 후 '확정' 버튼 클릭.
    -   출력: "사정 결과가 최종 확정되었습니다." 메시지. 합격/예비/불합격 명단이 확정 상태로 표시됨.

## 기능 4: 사정 데이터 출력물 생성

-   **관련 요구사항:** AMS-REQ-014: 사정 데이터 출력물 생성·관리
-   **입력 정보:**
    -   출력할 문서 종류 선택 (사정 총괄표, 합격자 명부, 예비자 명부 등).
    -   출력 대상 조건 선택 (모집 시기, 전형, 모집 단위 등).
    -   '출력' 또는 '다운로드' 버튼 클릭.
-   **출력 정보:** 선택한 종류의 사정 관련 문서가 보고서 형태(PDF, Excel 등)로 생성되어 다운로드되거나 미리보기로 표시됨.
-   **프로세스 설명:**
    1.  사용자가 필요한 사정 관련 출력물을 선택하고 조건을 설정한다.
    2.  '출력' 버튼을 클릭하면, 클라이언트는 해당 요청을 API로 전송한다.
    3.  서버는 DB의 확정된 사정 결과(`ADMISSION_DECISION` 등)를 조회하여, 요청된 문서 형식의 파일을 생성한다.
    4.  생성된 파일을 클라이언트로 전송하여 다운로드한다.
-   **호출 API 정보:**
    -   HTTP 메서드: GET 또는 POST (조건 복잡 시)
    -   API 엔드포인트: `/api/ams/admissions/reports/{reportType}` (예: `/api/ams/admissions/reports/summary-sheet`)
    -   API 목적: 특정 유형의 사정 결과 보고서 생성 및 다운로드
    -   요청 파라미터: `reportType` (Path Variable), 조회 조건 (Query Parameters or Body)
    -   응답 파라미터: 파일 스트림
-   **Mockup 데이터:** 없음 (파일 다운로드)

---

