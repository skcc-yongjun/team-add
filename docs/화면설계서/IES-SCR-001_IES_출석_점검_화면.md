# IES 출석 점검 화면 (IES-SCR-001)

## 사용 역할자: 출석 진행요원, 시스템 관리자 (IES)

---

## 기능 1: 출석 대상 수험생 목록 조회

-   **관련 요구사항:** IES-REQ-001 (프로그램 통합의 일부), IES-REQ-007 (수험생 데이터 입출력 및 명단 관리 결과 조회)
-   **입력 정보:**
    -   조회 조건 선택: 모집 시기, 전형, 고사일, 고사장, 조 (Group).
    -   '조회' 버튼 클릭.
-   **출력 정보:**
    -   선택된 조건의 출석 대상 수험생 목록 테이블 (수험번호, 이름, 생년월일, 지원학과, 고사장, 조, 출석 상태 - 미처리/출석/결시/실격, 가번호 - 부여된 경우).
    -   출석 현황 요약 (총 대상, 출석, 결시, 미처리 수).
-   **프로세스 설명:**
    1.  진행요원이 담당 고사장/조 등의 조건을 선택하고 조회한다.
    2.  클라이언트는 조건을 API로 전송하여 해당 고사/조의 수험생 목록 및 현재 출석 상태를 조회한다. (AMS에서 미리 전송받은 데이터 기반)
    3.  서버는 `EVALUATION` 테이블 등에서 대상자 정보를 조회하여 반환한다.
    4.  클라이언트는 목록과 요약 정보를 화면에 표시한다.
-   **호출 API 정보:**
    -   HTTP 메서드: GET
    -   API 엔드포인트: `/api/ies/attendance/list`
    -   API 목적: 출석 대상 수험생 목록 조회
    -   요청 파라미터: `admissionRound`, `examDate`, `examLocation`, `groupNumber`, etc.
    -   응답 파라미터:
        ```json
        {
          "summary": {"total": 50, "attended": 0, "absent": 0, "pending": 50},
          "attendees": [
            {
              "applicationId": 1001, "applicantId": "2024S0001", "name": "홍길동",
              "departmentName": "컴퓨터공학과", "examLocation": "공학관 101호", "groupNumber": "A",
              "attendanceStatus": "미처리", "tempId": null
            }, ...
          ]
        }
        ```
-   **Mockup 데이터 예시:**
    -   입력: 고사장 '공학관 101호', 조 'A' 선택 후 조회.
    -   출력: 해당 조의 수험생 50명 목록(모두 '미처리' 상태) 및 요약 정보 표시.

## 기능 2: 바코드/QR 기반 수험생 정보 확인 및 출석 처리

-   **관련 요구사항:** IES-REQ-002: 바코드·QR 기반 수험생 정보 확인, IES-REQ-001
-   **입력 정보:**
    -   바코드 스캐너 또는 카메라 앱으로 수험표의 바코드/QR 코드 스캔. (스캔된 데이터 자동 입력)
    -   또는 수험번호 직접 입력 필드에 입력 후 '확인' 버튼 클릭.
-   **출력 정보:**
    -   스캔/입력된 정보와 일치하는 수험생 정보 하이라이트 또는 팝업 표시 (수험번호, 이름, 사진 등 확인용).
    -   출석 처리 확인 버튼.
    -   처리 결과 메시지 (예: "홍길동님 출석 처리 완료").
    -   출석 목록 테이블에서 해당 수험생의 상태가 '출석'으로 변경되고 가번호가 표시됨.
    -   오류 시 메시지 (예: "해당 수험번호가 없습니다.", "이미 출석 처리된 수험생입니다.").
-   **프로세스 설명:**
    1.  진행요원이 수험생의 바코드/QR을 스캔하거나 수험번호를 입력한다.
    2.  클라이언트는 스캔/입력된 값을 사용하여 수험생 확인 및 출석 처리 API를 호출한다.
    3.  서버는 해당 수험생 정보를 조회하고, 유효한 대상인지, 이미 처리되었는지 확인한다.
    4.  유효한 경우, 해당 수험생의 출석 상태를 '출석'으로 변경하고, 가번호 부여 및 조 배정 로직(기능 3)을 트리거한다.
    5.  처리 결과(성공/실패, 부여된 가번호 등)를 클라이언트에 반환한다.
    6.  클라이언트는 결과를 메시지로 표시하고, 목록의 상태를 업데이트한다.
-   **호출 API 정보:**
    -   HTTP 메서드: POST
    -   API 엔드포인트: `/api/ies/attendance/check`
    -   API 목적: 수험생 확인 및 출석 처리, 가번호 부여
    -   요청 파라미터 (Body):
        ```json
        {
          "identifierType": "BARCODE", // 또는 QR, APPLICANT_ID
          "identifierValue": "스캔된 값 또는 입력된 수험번호",
          "examLocation": "현재 고사장 정보" // 필요시 조 배정 로직에 사용
        }
        ```
    -   응답 파라미터 (Success):
        ```json
        {
          "success": true,
          "message": "홍길동님 출석 처리 완료",
          "applicantInfo": { "applicationId": 1001, "name": "홍길동", ... },
          "assignedTempId": "A001", // 부여된 가번호
          "assignedGroup": "A" // 배정된 조
        }
        ```
    -   응답 파라미터 (Fail):
        ```json
        { "success": false, "errorCode": "NOT_FOUND", "errorMessage": "해당 수험번호가 없습니다." }
        ```
-   **Mockup 데이터 예시:**
    -   입력: 바코드 스캔 값 '2024S0001' 전송.
    -   출력 (성공): "홍길동님 출석 처리 완료" 메시지. 목록에서 홍길동 학생 상태 '출석', 가번호 'A001' 표시. 요약 정보 업데이트.

## 기능 3: 출석 시 가번호 부여 및 조 배정 (자동)

-   **관련 요구사항:** IES-REQ-003: 출석 시 가번호 부여 및 조배정
-   **입력 정보:** 기능 2의 출석 처리 성공 시 서버 내부적으로 트리거됨.
-   **출력 정보:** 기능 2의 응답에 부여된 가번호 및 배정된 조 정보 포함. 목록 테이블 업데이트.
-   **프로세스 설명:**
    1.  기능 2의 출석 처리 API가 호출되어 서버에서 유효한 출석으로 판단되면, 서버는 미리 설정된 규칙(순차적, 랜덤 등)에 따라 해당 수험생에게 고유한 가번호(temp\_id)를 부여한다.
    2.  필요시, 설정된 로직에 따라 평가 조(Group)를 배정한다. (이미 사전 배정된 경우 해당 정보 사용)
    3.  부여된 가번호와 조 정보를 `EVALUATION` 테이블 등에 기록하고, 기능 2의 응답에 포함시켜 클라이언트로 반환한다.
-   **호출 API 정보:** 기능 2 API의 서버 내부 로직으로 포함됨.
-   **Mockup 데이터:** 기능 2 참조.

## 기능 4: 수동 결시/실격 처리

-   **관련 요구사항:** IES-REQ-012: 실격·결시 등 특이사항 표기 (출석 단계에서 발생 시)
-   **입력 정보:**
    -   출석 목록 테이블에서 해당 수험생 선택.
    -   '결시 처리' 또는 '실격 처리' 버튼 클릭.
    -   (실격 시) 사유 입력 팝업에서 사유 선택 또는 입력 후 확인.
-   **출력 정보:** 해당 수험생의 상태가 '결시' 또는 '실격'으로 변경됨. 성공/실패 메시지.
-   **프로세스 설명:**
    1.  진행요원이 특정 수험생을 결시 또는 실격 처리해야 할 경우, 해당 버튼을 클릭한다.
    2.  클라이언트는 해당 수험생 ID와 처리 상태(결시/실격, 실격 사유)를 API로 전송한다.
    3.  서버는 `EVALUATION` 테이블 등에서 해당 수험생의 상태를 업데이트한다.
    4.  결과를 클라이언트에 반환하고, 클라이언트는 목록 상태를 업데이트하고 메시지를 표시한다.
-   **호출 API 정보:**
    -   HTTP 메서드: PUT 또는 PATCH
    -   API 엔드포인트: `/api/ies/attendance/status/{applicationId}`
    -   API 목적: 수험생 출석 상태 수동 변경 (결시/실격)
    -   요청 파라미터 (Path Variable): `applicationId`
    -   요청 파라미터 (Body):
        ```json
        {
          "status": "ABSENT", // 또는 DISQUALIFIED
          "reason": "신분증 미지참" // 실격 시 사유
        }
        ```
    -   응답 파라미터: 성공/실패 정보
-   **Mockup 데이터 예시:**
    -   입력: 특정 학생 선택 후 '결시 처리' 클릭.
    -   출력: 해당 학생 상태 '결시'로 변경, "결시 처리 완료" 메시지.

---

