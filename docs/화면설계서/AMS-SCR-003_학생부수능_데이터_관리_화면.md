# 학생부/수능 데이터 관리 화면 (AMS-SCR-003)

## 사용 역할자: 입학처 담당자, 시스템 관리자

---

## 기능 1: 학생부 데이터 일괄 업로드

-   **관련 요구사항:** AMS-REQ-003: 학생부 데이터 업로드·다운로드
-   **입력 정보:**
    -   '파일 선택' 버튼 클릭하여 교육행정정보시스템(NEIS) 등에서 다운로드한 표준 학생부 데이터 파일(XML, CSV 등) 선택.
    -   '업로드 및 처리 시작' 버튼 클릭.
    -   처리 옵션 선택 (예: 기존 데이터 덮어쓰기, 신규 데이터만 추가 등).
-   **출력 정보:**
    -   업로드 진행률 표시 (프로그레스 바).
    -   처리 결과 요약: 총 처리 대상 건수, 성공 건수, 실패 건수, 실패 사유 (로그 다운로드 링크).
    -   업로드 이력 목록 (업로드 일시, 파일명, 처리자, 결과 요약).
-   **프로세스 설명:**
    1.  사용자가 학생부 데이터 파일을 선택하고 처리 옵션을 설정한 후 업로드를 시작한다.
    2.  클라이언트는 파일을 서버의 파일 업로드 API로 전송한다. (대용량 파일 처리 방식 고려: 청킹 등)
    3.  서버는 업로드된 파일을 임시 저장하고, 비동기 처리(Batch Job)를 시작한다. 파일 유효성 검사(형식, 필수 데이터 누락 등)를 수행한다.
    4.  서버는 파일 내용을 파싱하여 각 지원자별 학생부 데이터를 추출하고, `APP_DOCUMENT` 테이블 또는 별도 학생부 데이터 테이블에 저장/업데이트한다. (기존 지원서 정보와 매칭 필요)
    5.  처리 진행 상황 및 최종 결과를 DB에 기록하고, 클라이언트가 조회할 수 있도록 상태를 업데이트한다. (웹소켓 등으로 실시간 피드백 가능)
    6.  클라이언트는 주기적으로 처리 상태를 확인하거나, 서버 푸시를 받아 진행률 및 최종 결과를 화면에 표시한다.
-   **호출 API 정보:**
    -   파일 업로드 API:
        -   HTTP 메서드: POST
        -   API 엔드포인트: `/api/ams/data/upload/student-records`
        -   API 목적: 학생부 데이터 파일 업로드 요청
        -   요청 파라미터: `multipart/form-data` (파일 데이터), `processOptions` (JSON 문자열 등)
        -   응답 파라미터: `{ "jobId": "배치작업 ID", "message": "업로드 요청 접수됨" }`
    -   처리 상태 조회 API:
        -   HTTP 메서드: GET
        -   API 엔드포인트: `/api/ams/data/upload/status/{jobId}`
        -   API 목적: 파일 처리 배치 작업 상태 및 결과 조회
        -   응답 파라미터:
            ```json
            {
              "jobId": "배치작업 ID",
              "status": "COMPLETED", // PROCESSING, FAILED 등
              "progress": 100,
              "totalCount": 1500,
              "successCount": 1490,
              "failureCount": 10,
              "errorLogUrl": "/api/ams/data/upload/logs/jobId_error.log" // 실패 로그 다운로드 URL
            }
            ```
-   **Mockup 데이터 예시:**
    -   입력: `student_records_2024.xml` 파일 선택, '덮어쓰기' 옵션 선택.
    -   출력: 업로드 진행률 표시 후, 최종 결과 "총 1500건 처리, 성공 1490건, 실패 10건" 메시지 및 로그 다운로드 링크 표시. 업로드 이력에 해당 내역 추가.

## 기능 2: 수능 데이터 일괄 업로드

-   **관련 요구사항:** AMS-REQ-004: 수능 데이터 업로드·다운로드
-   **입력 정보:** '파일 선택' 버튼 클릭하여 한국교육과정평가원(KICE) 등에서 받은 표준 수능 성적 파일 선택. '업로드 및 처리 시작' 버튼 클릭. 처리 옵션 선택.
-   **출력 정보:** 학생부 업로드와 유사. 처리 결과 요약, 업로드 이력 등.
-   **프로세스 설명:** 학생부 업로드 프로세스와 동일하나, 처리 대상 데이터 및 매핑 로직이 수능 성적 기준으로 변경됨. 수능 성적은 `EVALUATION` 테이블 또는 별도 성적 테이블에 반영될 수 있음.
-   **호출 API 정보:**
    -   파일 업로드 API: `/api/ams/data/upload/csat-scores`
    -   처리 상태 조회 API: `/api/ams/data/upload/status/{jobId}` (동일 API 사용 가능, Job 유형으로 구분)
    -   (API 구조 및 응답은 학생부와 유사)
-   **Mockup 데이터 예시:** 학생부와 유사.

## 기능 3: 학생부/수능 데이터 다운로드

-   **관련 요구사항:** AMS-REQ-003, AMS-REQ-004 (데이터 다운로드)
-   **입력 정보:**
    -   다운로드할 데이터 유형 선택 (학생부, 수능).
    -   필요시 특정 조건 선택 (모집 시기, 전형 등).
    -   '데이터 다운로드' 버튼 클릭.
-   **출력 정보:** 조건에 맞는 학생부 또는 수능 데이터가 표준 형식 파일(CSV, Excel 등)로 생성되어 다운로드됨.
-   **프로세스 설명:**
    1.  사용자가 다운로드할 데이터 유형 및 조건을 선택하고 버튼을 클릭한다.
    2.  클라이언트는 선택된 조건을 API로 전송한다.
    3.  서버는 조건에 맞는 데이터를 DB에서 조회하여 표준 파일 형식으로 생성한다. (대용량 데이터의 경우 비동기 생성 후 다운로드 링크 제공 방식 고려)
    4.  생성된 파일을 클라이언트로 전송하여 다운로드한다.
-   **호출 API 정보:**
    -   HTTP 메서드: GET 또는 POST (조건이 복잡할 경우)
    -   API 엔드포인트: `/api/ams/data/download/student-records` 또는 `/api/ams/data/download/csat-scores`
    -   API 목적: 조건에 맞는 데이터 파일 다운로드
    -   요청 파라미터: 조회 조건 (Query Parameters 또는 Request Body)
    -   응답 파라미터: 파일 스트림
-   **Mockup 데이터:** 없음 (파일 다운로드)

---

